# üö® –û–¢–ß–ï–¢ –ü–û –ê–£–î–ò–¢–£ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. üîê JWT Secret –≤ Production
**–ë—ã–ª–æ:** Hardcoded fallback —Å–µ–∫—Ä–µ—Ç –≤ –∫–æ–¥–µ  
**–°—Ç–∞–ª–æ:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT_SECRET –∏–∑ env  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

### 2. üõ°Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–ë—ã–ª–æ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ Chat API  
**–°—Ç–∞–ª–æ:** –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è + —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

### 3. üîç –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏  
**–ë—ã–ª–æ:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production  
**–°—Ç–∞–ª–æ:** –£—Å–ª–æ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ dev  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

### 4. ‚öôÔ∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Rate Limiter
**–ë—ã–ª–æ:** –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π parseInt()  
**–°—Ç–∞–ª–æ:** –í–∞–ª–∏–¥–∞—Ü–∏—è env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

## üî• –û–°–¢–ê–í–®–ò–ï–°–Ø –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. üîì –ü–∞—Ä–æ–ª–∏ –±–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```typescript
// app/api/auth/login/route.ts:37
password, // Plain text storage!
```
**–†–µ—à–µ–Ω–∏–µ:** 
```bash
npm install bcryptjs @types/bcryptjs
```

### 2. üíæ In-memory storage –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```typescript
const registeredUsers = new Map<string, { email: string, password: string, name: string }>()
```
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (PostgreSQL/MongoDB)

## ‚ö†Ô∏è –í–´–°–û–ö–ò–ï –†–ò–°–ö–ò

### 3. üåê –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** API endpoints —É—è–∑–≤–∏–º—ã –∫ CSRF –∞—Ç–∞–∫–∞–º  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã –∏–ª–∏ SameSite cookies

### 4. üè∑Ô∏è –°–ª–∞–±–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è Rate Limiter
**–ü—Ä–æ–±–ª–µ–º–∞:** IP + User Agent –ª–µ–≥–∫–æ –æ–±—Ö–æ–¥–∏—Ç—Å—è  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å User ID –∏–∑ JWT —Å–µ—Å—Å–∏–∏

### 5. üìä –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Content Security Policy
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç XSS –∞—Ç–∞–∫  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å CSP headers

## üîß –ù–ï–ó–ê–ü–û–õ–ù–ï–ù–ù–´–ï ENVIRONMENT VARIABLES

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ:
```env
‚ùå OPENAI_API_KEY=your_openai_api_key_here
‚ùå GOOGLE_CLIENT_ID=your_google_client_id_here  
‚ùå GOOGLE_CLIENT_SECRET=your_google_client_secret_here
‚ùå NEXTAUTH_SECRET=your_nextauth_secret_here
‚úÖ JWT_SECRET=lCge2+hcSycRAISvyXvmqLQNYlLpVcTIO/IuG4NYnBw= (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (—Å defaults):
```env
‚úÖ NEXTAUTH_URL=http://localhost:3000 (–µ—Å—Ç—å fallback)
‚úÖ RATE_LIMIT_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–µ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ defaults)
```

## üìã –ü–õ–ê–ù –î–ê–õ–¨–ù–ï–ô–®–ò–• –î–ï–ô–°–¢–í–ò–ô

### –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–ö–†–ò–¢–ò–ß–ù–û):
1. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** - –¥–æ–±–∞–≤–∏—Ç—å bcrypt
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –∑–∞–º–µ–Ω–∏—Ç—å in-memory storage  
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å env variables** - –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –í –ë–õ–ò–ñ–ê–ô–®–ï–ï –í–†–ï–ú–Ø:
4. **CSRF –∑–∞—â–∏—Ç–∞** - –¥–æ–±–∞–≤–∏—Ç—å middleware  
5. **Content Security Policy** - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
6. **–£–ª—É—á—à–∏—Ç—å Rate Limiter** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å User ID
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º** - –¥–æ–±–∞–≤–∏—Ç—å zod —Å—Ö–µ–º—ã

### –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û:
8. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
9. **Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** - —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
10. **Security headers** - HSTS, X-Frame-Options, –∏ –¥—Ä.

## üéØ –û–¶–ï–ù–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –†–ò–°–ö**
- Hardcoded secrets
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: üü° **–°–†–ï–î–ù–ò–ô –†–ò–°–ö**  
- –û—Å–Ω–æ–≤–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –û—Å—Ç–∞—é—Ç—Å—è –ø—Ä–æ–±–ª–µ–º—ã —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
- –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –¶–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å: üü¢ **–ù–ò–ó–ö–ò–ô –†–ò–°–ö**
- –ù—É–∂–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π  
- CSRF –∑–∞—â–∏—Ç–∞

## üîí COMPLIANCE CHECKLIST

‚úÖ Rate Limiting –∞–∫—Ç–∏–≤–µ–Ω  
‚úÖ JWT —Å–µ–∫—Ä–µ—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã  
‚úÖ Input validation —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±–µ–∑ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π  
‚ùå Password hashing –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
‚ùå CSRF –∑–∞—â–∏—Ç–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
‚ùå Persistent storage –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  

**–û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: 60/100**

---

## üöÄ –ë–´–°–¢–†–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
```bash
# –°–æ–∑–¥–∞—Ç—å .env.local —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
cp env.example .env.local
```

### 2. –î–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π:
```bash
npm install bcryptjs @types/bcryptjs
```

### 3. –î–ª—è CSRF –∑–∞—â–∏—Ç—ã:
```bash
npm install csrf
```

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: **–ü–ê–†–û–õ–ò ‚Üí –ë–î ‚Üí CSRF ‚Üí CSP** 